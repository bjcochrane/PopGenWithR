---
title: 
- <center>Isolation by Distance</center>
output:
  html_document:
    css: Chapter.css
    toc: yes
    toc_depth: 5
---
```{r,echo=FALSE}
library(TeachingPopGen)
```

### Background

Heretofore, we have not let geographic distance into the picture.  In our island model, for example, we assumed equal rates of migration among all islands, regardless of location.  A more realistic model, particularly for a series of continental populations, would involve migration rate as an inverse function of the distance between pairs of populations.  The question we thus have is to accomplish this.

Rather than use the modeling approach we have previously, we will instead apply a model developed by [Rousset (1997)](http://www.genetics.org/content/145/4/1219.short) to some original data.  What he showed was that, if we consider distance to be one dimension, then in fact,  Fst(1-Fst) would be expected to be a linear function of geographic distance.  More sophisticated models could be developed for three dimensions, but they go beyond what we need to consider

### Some data

[Jensen et al (2013)](http://onlinelibrary.wiley.com/doi/10.1111/mec.12226/full) reported a survey of microsatellite variation in sparrows along the Atlantic coast of Norway.  14 populations were genotyped at 15 microsatellite loci.  The genotype data were deposited in Dryad; in addition, spatial coordinates of the population sites were reported in the paper.  I have used Genalex to calculate pairwise Fst values; in addition, the coordinates were converted to distances (km), and both data sets were saved as triangular matrices.  We will read both of them in and convert them to vectors, in order that we can plot the Rousset relationship

Load the distance matrices:
```{r}
data(Sparrow)
attach(sparrow.dat)
```

```{r}

dist.km.vec <-dist.km[!is.na(dist.km)]
dist.km.vec
```
And then the Fst one
```{r}

dist.fst.vec <-dist.fst[!is.na(dist.fst)]
dist.fst.vec
```
Now we will calculate Fst/1-Fst and plot it against distance.  We will then calculate the regression line and add it to the plot
```{r}
Fsthat <-dist.fst.vec/(1-dist.fst.vec)

plot(dist.km.vec,Fsthat, xlab="Distance(km)", ylab="Fst/(1-Fst)", pch=16)

reg <-lm(Fsthat~(dist.km.vec))
summary(reg)
abline(reg,col="red")
```
Note that there is trend, but it is not significant. we also see that there is a collection of outliers that do not appear to be consistent with the rest.  we can see this more clearly if we make a histogram of the pairwise Fst values:  

```{r}
hist(dist.fst.vec, main="Distribution of Pairwise Fst Values", xlab="Fst")
```
In fact, Jensen et al. explain this in their paper by noting that in fact the populations sampled included ones from both the islands and the mainland.  When they performed the same analysis  with mainland-mainland, mainland-island, or island-island comparisons, they observed the following:

![Data](http://dl.dropboxusercontent.com/u/9752688/QPopgen/figs/SparrowFst.png)

The strongest relationship was observed in the mainland-mainland comparisons (filled circles; solid line); Fst values in general were higher for island-island comparisons.

### Conclusions

What we have done here is a very preliminary analysis; in real life we would have coded the data in such a way that we could, perhaps, look at nested F statistics or broken them out as shown above.  But this is an excellent example of how, combining theory, geography, and genetic data, we can obtain real insights into population differentiation.